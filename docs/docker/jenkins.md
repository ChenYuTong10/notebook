# ‚öôÔ∏è Jenkins Configuration

## üëÄ What is jenkins

`Jenkins` is an open-source automation tool that is used to build, test and deploy software projects. It provides a wide range of features and functionality to automate the entire software development process, including continuous integration (CI) and continuous delivery (CD).

Jenkins is highly extensible and has a large ecosystem of plugins that allow users to customize and configure the tool to their specific needs. It is designed to work with various programming languages, build tools, and version control systems, making it a popular choice among developers and DevOps teams.

Jenkins is often used in conjunction with other tools in a software development stack, such as Git, Docker, and Kubernetes, to automate the entire software development and deployment process. It is widely adopted by many organizations, from small startups to large enterprises, to improve their software development workflows and increase productivity.

::: tip
All above is generated by `ChatGPT`.ü•±
:::

## üî® How to run jenkins

Only running jenkins is simple. But there is a bit of mess if you need to integrate the runtime environment in jenkins.
You need to collect the commands and methods to download the environment you need.

The following dockerfile integrates *golang*, *nodejs* and *python* environment.

```dockerfile
FROM jenkins/jenkins:alpine

# switch to root user and set some needed environments
USER root

# set alpine mirror
# Tsinghua mirror
RUN sed -i "s/dl-cdn.alpinelinux.org/mirrors.ustc.edu.cn/g" /etc/apk/repositories
# AliYun mirror
# RUN sed -i 's/dl-cdn.alpinelinux.org/mirrors.aliyun.com/g' /etc/apk/repositories
# Tencent mirror
# RUN sed -i 's/dl-cdn.alpinelinux.org/mirrors.tencent.com/g' /etc/apk/repositories

# update packages
RUN apk update

# set timezone
# the time in docker container may not be same as your region, so it is needed to set timezone manally
# more zones to see https://en.wikipedia.org/wiki/List_of_tz_database_time_zones
RUN apk add --no-cache tzdata
ENV TZ=Asia/Shanghai

# install needed packages
RUN apk add --no-cache rsync sudo vim wget curl \
    git openssh-client bash unzip xz coreutils \
    build-base alpine-sdk openjdk11 cmake make \
    musl musl-dev gcc gettext-dev libintl openssl

RUN apk upgrade

# install golang environment

ENV GOROOT="/usr/local/go"
ENV GOSUMDB="sum.golang.google.cn"
ENV GOPROXY="https://goproxy.io,direct"
ENV PATH="/usr/local/go/bin:${PATH}"

COPY --from=golang:1.19-alpine $GOROOT $GOROOT

# install node environment

RUN apk add --update nodejs-current npm

# install python environment

RUN apk add --update --no-cache python3 \
    && ln -sf python3 /usr/bin/python
# -m makes sure that you are using the pip that's tied to the active Python executable.
# more to see https://stackoverflow.com/questions/50821312/meaning-of-python-m-flag
RUN python3 -m ensurepip
RUN pip3 install --no-cache --upgrade pip setuptools

# install docker engine
# host and the container will share the same docker engine in this case.
# https://stackoverflow.com/questions/54099218/how-can-i-install-docker-inside-an-alpine-container
RUN apk add --update docker openrc \
    && rc-update add docker boot
# need to mount "/var/run/docker.sock:/var/run/docker.sock:rw" when running the container.

# jenkins iniital configurations
# see https://www.jenkins.io/doc/book/installing/initial-settings/
# ENV JENKINS_OPTS --httpPort=8080 --httpListenAddress=127.0.0.1

# Maybe you can see some configurations like 'ARG user=jenkins', 'ARG http_port=8080' etc in other Dockerfile.
# These are the built-in configurations in the official jenkins image.
```